<table
  cTable
  [hover]="defs().table?.hover ?? true"
  [responsive]="defs().table?.responsive ?? true"
  [striped]="defs().table?.striped ?? false"
  [ngClass]="defs().table?.tableClasses ?? []"
  [small]="defs().table?.small ?? false"
>
  @if (columnsCount() > 0) {
    <thead class="text-nowrap text-truncate">
      <tr>
        @for (field of headerFields(); track field) {
          @let col = defs().columns[field];
          <th
            [ngClass]="(col.headerClasses ?? []).concat(['bg-body-tertiary'])"
            [width]="col.width ?? ''"
          >
            @if (col.headerText) {
              {{ col.headerText }}
            } @else if (col.headerTemplate) {
              <ng-container
                *ngTemplateOutlet="col.headerTemplate"
              ></ng-container>
            }
          </th>
        }
      </tr>
    </thead>
  }

  <tbody>
    @if (dataSource | withLoading | async; as response) {
      @if (response.loading) {
        <tr>
          <td [attr.colspan]="columnsCount()">
            <app-loading [small]="true" />
          </td>
        </tr>
      } @else {
        @if (response.value.length == 0) {
          <tr>
            <td [attr.colspan]="columnsCount()">
              <svg cIcon name="cilWarning" size="md"></svg>
              Nebyly načteny žádné data.
            </td>
          </tr>
        } @else {
          @for (row of response.value; track $index) {
            <tr>
              @for (column of row; track $index) {
                <td [ngClass]="column.columnDef.dataClasses ?? []">
                  {{ column.value | async }}
                </td>
              }
            </tr>
          }
        }
      }
    }
  </tbody>
</table>
